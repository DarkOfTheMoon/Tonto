<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
  <META name="robots" content="noindex, nofollow">
  <TITLE>Formal rules for valid foo preprocessor code</TITLE>
  <LINK REL="next" HREF="node14.html">
  <LINK REL="previous" HREF="node12.html">
  <LINK REL="up" HREF="node12.html">
  <LINK REL="next" HREF="node14.html">
</HEAD>
<BODY BGCOLOR="#FFFBF0">
<!--Navigation Panel-->
<B> Next:</B> <A HREF="node14.html">Actions performed by the</A>
<B> Up:</B> <A HREF="node12.html">The foo preprocessor language</A>
<B> Previous:</B> <A HREF="node12.html">The foo preprocessor language</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H2>Formal rules for valid <TT>foo</TT> preprocessor code</H2>

<P>
The rules for a valid <TT>foo</TT> code are the same as for Fortran95
except for the following restrictions:

<P>
<UL>
<P>
<LI>
The Fortran95 keywords:
<TT>subroutine</TT>, <TT>function</TT>, and <TT>module procedure</TT>
are banned. 

<P>
<BLOCKQUOTE>
<TT>foo</TT> automatically inserts the approriate keywords. 
</BLOCKQUOTE>
<P>
<LI>
For <TT>foo</TT> module <TT>M</TT> the automatically generated interface file <TT>m.int</TT>
must be included after any <TT>use</TT> statements.

<P>
<LI>
For <TT>foo</TT> module <TT>M</TT>, routine names <TT>m</TT> which are the same are assumed 
to be deliberately overloaded and it is illegal to explicitly define
an generic interface name <TT>_m</TT> in this case.

<P>
<BLOCKQUOTE>
The reason is that an appropriate generic interface is generated in the 
interface file <TT>m.int</TT>. 
</BLOCKQUOTE>
<P>
<LI>
The Fortran95 syntax for declaring <TT>recursive</TT>, <TT>pure</TT>, and <TT>elemental</TT>
routines is modified as described in the next section.

<P>
<LI>
The Fortran95 keywords: <TT>program</TT>, <TT>module</TT>, <TT>interface</TT>, <TT>select</TT>, 
<TT>type</TT>, <TT>else</TT>, <TT>do</TT>, <TT>contains</TT>, <TT>if</TT>, <TT>then</TT>, must not be used 
on a line with multiple statement, involving the character <TT>;</TT>

<P>
<LI>
For every <TT>foo</TT> module <TT>M</TT>, a corresponding macro with the same name
must be defined in the file <TT>macros</TT>. The macro <TT>M</TT> must expand 
to the actual type definition used and manipulated in that module.

<P>
<BLOCKQUOTE>
The macro definition file <TT>macros</TT> must be <TT>included</TT> after any <TT>use</TT> statements, if any. 
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
The macros must be defined after the <TT>use</TT> statements 
since the module and macro names are required to be the same!
</BLOCKQUOTE>
<P>
<LI>
Expressions involving the dot character <TT>.</TT> are banned except for real
number constants. In particular, C-preprocessor macros must be used for the
logicals .true. , .false. , .not. and so on.

<P>
<LI>If <TT>m</TT> is a structure component of derived type <TT>M</TT>, then in
<TT>foo</TT> module <TT>M</TT> there is a routine <TT>m</TT> which returns that structure
component. 

<P>
<BLOCKQUOTE>
In module <TT>SHELL</TT> there is a routine with name
<TT>ex</TT> which returns <TT>self%ex</TT> where <TT>self</TT> is of type <TT>SHELL</TT>.
This class of routines are called ``inquiry'' or ``get'' routines.
</BLOCKQUOTE>
<P>
</UL>
<P>
<HR>
</BODY>
</HTML>
