! Copyright (C) Dylan Jayatilaka, 1999
!
! This library is free software; you can redistribute it and/or
! modify it under the terms of the GNU Library General Public
! License as published by the Free Software Foundation; either
! version 2 of the License, or (at your option) any later version.
!
! This library is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
! Library General Public License for more details.
!
! You should have received a copy of the GNU Library General Public
! License along with this library; if not, write to the
! Free Software Foundation, Inc., 59 Temple Place - Suite 330,
! Boston, MA  02111-1307, USA.
!
! $Id$

program run_gaussian2

   use TYPES
   use SYSTEM
   use TEXTFILE
   use GAUSSIAN2

   implicit none

   g :: GAUSSIAN2
   S :: REALMAT(10,6)
   d :: DFTGRID*

   tonto.initialize
   stdout.create_stdout
   stdout.open

   stdout.flush
   stdout.text("Make the overlap integrals between two gaussian functions:")
   stdout.flush
   stdout.text("--an F function at (0,0,0) with exponent 0.3, and")
   stdout.text("--a  D function at (0,0,1) with exponent 0.5")
   stdout.flush

   g.set(l_a=3,pos_a=[0.0d0,0.0d0,0.0d0],ex_a=0.3d0, &
         l_b=2,pos_b=[0.0d0,0.0d0,0.1d0],ex_b=0.5d0)

   g.make_overlap_ints(S)

   stdout.set_fields(3)

   stdout.text("Answer:")
   stdout.put(S)

   stdout.flush
   stdout.text("Now make the nuclear attaction integrals for the same functions")
   stdout.text("assuming the nucleus of unit charge is at (0,1,0)")
   stdout.flush

   g.make_nuclear_attraction_ints(S,c=[0.0d0,1.0d0,0.0d0])

   stdout.text("Answer:")
   stdout.put(S)

   stdout.flush
   stdout.text("Now do the last integration numerically with a default DFT grid")
   stdout.flush

   d.create
   d.set_defaults

   d.make_matrix_elements_of(v010,g,S)

   stdout.text("Answer:")
   stdout.put(S)

end
